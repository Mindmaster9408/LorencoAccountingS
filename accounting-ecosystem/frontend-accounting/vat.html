<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAT Management - Lorenco Accounting</title>
    <script src="js/navigation.js"></script>
    <script src="js/ledger.js"></script>
    <!--
    ═══════════════════════════════════════════════════════════════════════════════
    VAT RECONCILIATION SYSTEM - COMPLETED AND LOCKED
    ═══════════════════════════════════════════════════════════════════════════════
    
    STATUS: COMPLETE - DO NOT MODIFY UNLESS EXPLICITLY REQUESTED
    
    This VAT reconciliation system includes:
    - VAT Reconciliation Table with auto-calculations (Total Output A, Total Input B, VAT Payable, Difference)
    - Trial Balance section with VAT/NO VAT inputs and automatic totals
    - Reconciliation Comparison (INCOME/EXPENSE) with automatic calculations:
      * According to VAT Report (Excl) = Inclusive - Output
      * According to TB = Trial Balance VAT totals
      * Difference = TB - VAT Report
      * Percentage = (Difference / TB) × 100
    - All calculations update in real-time across all sections
    
    MODIFICATION POLICY:
    Only modify this file if specifically requested to work on VAT reconciliation.
    For other features, create separate files or work in designated sections.
    
    ═══════════════════════════════════════════════════════════════════════════════
    -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f8f9fa;
        }
        
        .top-bar {
            background: linear-gradient(135deg, #0066cc 0%, #0099ff 100%);
            color: white;
            padding: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
            box-shadow: 0 2px 8px rgba(0,102,204,0.2);
        }
        
        .brand-section {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 0 25px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            font-weight: 700;
        }
        
        .logo-icon {
            width: 35px;
            height: 35px;
            background: white;
            color: #0066cc;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
        }
        
        .company-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255,255,255,0.15);
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .company-selector:hover {
            background: rgba(255,255,255,0.25);
        }
        
        .right-section {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 0 25px;
        }
        
        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255,255,255,0.15);
            border: none;
            color: white;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 16px;
        }
        
        .icon-btn:hover {
            background: rgba(255,255,255,0.25);
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;
            transition: background 0.2s;
        }
        
        .user-menu:hover {
            background: rgba(255,255,255,0.15);
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: white;
            color: #0066cc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
        }
        
        .user-name {
            font-size: 14px;
            font-weight: 500;
        }
        
        .navbar {
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            padding: 0 25px;
            gap: 5px;
        }
        
        .nav-item {
            position: relative;
        }
        
        .nav-item > a {
            display: block;
            padding: 16px 20px;
            color: #202124;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
        }
        
        .nav-item > a:hover,
        .nav-item > a.active {
            color: #0066cc;
            border-bottom-color: #0066cc;
            background: rgba(0,102,204,0.05);
        }
        
        .dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-radius: 8px;
            min-width: 220px;
            padding: 8px 0;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s;
            z-index: 1000;
        }
        
        .nav-item:hover .dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown a {
            display: block;
            padding: 10px 20px;
            color: #202124;
            text-decoration: none;
            font-size: 14px;
            transition: background 0.2s;
        }
        
        .dropdown a:hover {
            background: rgba(0,102,204,0.08);
            color: #0066cc;
        }
        
        .dropdown-header {
            padding: 8px 20px 4px;
            color: #9aa0a6;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 25px;
        }
        
        .page-header {
            margin-bottom: 30px;
        }
        
        .page-header h1 {
            font-size: 28px;
            color: #202124;
            margin-bottom: 8px;
        }
        
        .page-header p {
            color: #666;
            font-size: 14px;
        }
        
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-left: 4px solid #0066cc;
        }
        
        .stat-card h3 {
            font-size: 13px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 28px;
            font-weight: 700;
            color: #0066cc;
            margin-bottom: 5px;
        }
        
        .stat-card .subtext {
            font-size: 12px;
            color: #999;
        }
        
        .report-controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 25px;
            display: flex;
            gap: 20px;
            align-items: end;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .control-group label {
            font-size: 12px;
            color: #666;
            font-weight: 600;
        }
        
        .control-group select,
        .control-group input {
            padding: 10px 14px;
            border: 1px solid #e8eaed;
            border-radius: 6px;
            font-size: 14px;
            min-width: 180px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0066cc 0%, #0099ff 100%);
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: white;
            color: #0066cc;
            border: 1px solid #0066cc;
            padding: 10px 24px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-secondary:hover {
            background: rgba(0,102,204,0.05);
        }
        
        .btn-link {
            background: none;
            color: #0066cc;
            border: none;
            padding: 4px 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: underline;
            transition: color 0.2s;
        }
        
        .btn-link:hover {
            color: #0099ff;
        }
        
        .btn-link:disabled {
            color: #999;
            cursor: not-allowed;
            text-decoration: none;
        }
        
        .report-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .report-header {
            background: linear-gradient(135deg, #0066cc 0%, #0099ff 100%);
            color: white;
            padding: 25px;
        }
        
        .report-header h2 {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .report-header p {
            font-size: 13px;
            opacity: 0.9;
        }
        
        .report-content {
            padding: 30px;
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .report-table th {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 2px solid #e8eaed;
            color: #666;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .report-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #f1f3f4;
            color: #202124;
            font-size: 14px;
        }
        
        .report-table tr:hover {
            background: rgba(0,102,204,0.02);
        }
        
        .amount {
            text-align: right;
            font-family: 'Courier New', monospace;
        }
        
        .grand-total {
            font-weight: 700;
            background: rgba(0,102,204,0.08);
            border-top: 2px solid #0066cc;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-submitted {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        .status-pending {
            background: #fff3e0;
            color: #ef6c00;
        }
    </style>
    <link rel="stylesheet" href="css/dark-theme.css">
</head>
<body>

    <div class="container">
        <div class="page-header">
            <h1>VAT Management</h1>
            <p>VAT return submissions and compliance tracking</p>
        </div>
        
        <div class="card-grid">
            <div class="stat-card">
                <h3>Current Period Output VAT</h3>
                <div class="value" id="outputVatValue">R 34,102.83</div>
                <div class="subtext">VAT Collected - January 2026</div>
            </div>
            <div class="stat-card">
                <h3>Current Period Input VAT</h3>
                <div class="value" id="inputVatValue">R 17,145.00</div>
                <div class="subtext">VAT Paid - January 2026</div>
            </div>
            <div class="stat-card">
                <h3>VAT Payable to SARS</h3>
                <div class="value" id="vatPayableValue">R 16,957.83</div>
                <div class="subtext">Due: 25 Feb 2026</div>
            </div>
        </div>
        
        <div class="report-controls">
            <div class="control-group">
                <label>Actions</label>
                <select>
                    <option>View VAT Return</option>
                    <option>Submit Return</option>
                    <option>Payment History</option>
                    <option>VAT Settings</option>
                </select>
            </div>
            <button class="btn-primary" onclick="viewReturn()">View Current Return</button>
            <button class="btn-secondary" onclick="openVATRecon()">VAT Reconciliation</button>
            <button class="btn-secondary" onclick="submitReturn()">Submit to SARS</button>
            <button class="btn-secondary" onclick="makePayment()">Make Payment</button>
        </div>

        <div class="report-card" id="vatReconSection" style="display: none;">
            <div class="report-header">
                <h2>VAT Reconciliation January 2026</h2>
                <p>VAT REPORT SUMMARY</p>
            </div>
            
            <div class="report-content">
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                        <thead>
                            <tr style="background: white;">
                                <th style="border: none; padding: 8px;"></th>
                                <th colspan="6" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #e8f4f8;">Income (Output)</th>
                                <th colspan="5" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #fff3e6;">Expenses (Input)</th>
                                <th rowspan="4" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #d4edda;">VAT payable (A)<br>- (B)</th>
                                <th rowspan="4" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #fff3e0;">Statement of<br>Account</th>
                                <th rowspan="4" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #ffebee;">Difference</th>
                                <th rowspan="4" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #f5f5f5;">Authorisation</th>
                            </tr>
                            <tr style="background: #e8eaed;">
                                <th rowspan="3" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600;">VAT Period</th>
                                <th colspan="2" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #d4e3f7;">STANDAARD UITSETTE</th>
                                <th colspan="2" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #d4e3f7;">KAPITALE UITSETTE</th>
                                <th rowspan="3" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600;">Zero Rate</th>
                                <th rowspan="3" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600;">Total Output(A)</th>
                                <th colspan="2" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; font-size: 11px; background: #ffe6cc;">Standard Inputs</th>
                                <th rowspan="2" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; font-size: 11px; background: #ffe6cc;">Capital Goods<br>supplied to you<br>(15%)</th>
                                <th rowspan="2" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; font-size: 11px; background: #ffe6cc;">Bad<br>Debts</th>
                                <th rowspan="2" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; font-size: 11px; background: #ffe6cc;">Total Input<br>(B)</th>
                            </tr>
                            <tr style="background: #e8eaed;">
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 11px; font-weight: 500;">Inclusive Income (115%)</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 11px; font-weight: 500;">Output (15%)</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 11px; font-weight: 500;">Standard Rate Capital Goods (115%)</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 11px; font-weight: 500;">Capital Goods Output (15%)</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; font-size: 11px; background: #ffe6cc;">Inclusive Expenses<br>(115%)</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; font-size: 11px; background: #ffe6cc;">Input<br>(15%)</th>
                            </tr>
                        </thead>
                        <tbody id="vatReconTable">
                            <tr data-period="2025.03">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600; text-align: center;">2025.03</td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input output-15" data-row="2025.03" style="width: 100%; border: none; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-output-15" data-row="2025.03" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="total-output-a" data-row="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input input-15" data-row="2025.03" style="width: 100%; border: none; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-goods-15" data-row="2025.03" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input bad-debts" data-row="2025.03" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #ffe6cc;"><span class="total-input-b" data-row="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #d4edda;"><span class="vat-payable" data-row="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 4px; text-align: center; background: #fff3e0;"><input type="number" step="0.01" placeholder="0.00" class="soa-input" data-row="2025.03" style="width: 90%; border: 1px solid #ccc; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #ffebee;"><span class="difference" data-row="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center; background: #f5f5f5;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                            </tr>
                            <tr data-period="2024.04">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600; text-align: center;">2024.04</td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input output-15" data-row="2024.04" style="width: 100%; border: none; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-output-15" data-row="2024.04" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="total-output-a" data-row="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input input-15" data-row="2024.04" style="width: 100%; border: none; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-goods-15" data-row="2024.04" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input bad-debts" data-row="2024.04" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #ffe6cc;"><span class="total-input-b" data-row="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #d4edda;"><span class="vat-payable" data-row="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 4px; text-align: center; background: #fff3e0;"><input type="number" step="0.01" placeholder="0.00" class="soa-input" data-row="2024.04" style="width: 90%; border: 1px solid #ccc; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #ffebee;"><span class="difference" data-row="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center; background: #f5f5f5;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                            </tr>
                            <tr data-period="2024.05">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600; text-align: center;">2024.05</td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input output-15" data-row="2024.05" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-output-15" data-row="2024.05" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="total-output-a" data-row="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input input-15" data-row="2024.05" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-goods-15" data-row="2024.05" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input bad-debts" data-row="2024.05" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #ffe6cc;"><span class="total-input-b" data-row="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #d4edda;">-</td>
                                <td style="border: 1px solid #ccc; padding: 4px; text-align: center; background: #fff3e0;"><input type="number" step="0.01" placeholder="0.00" class="soa-input" data-row="2024.05" style="width: 90%; border: 1px solid #ccc; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffebee;"><span class="difference" data-row="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center; background: #f5f5f5;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                            </tr>
                            <tr data-period="2024.06">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600; text-align: center;">2024.06</td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input output-15" data-row="2024.06" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-output-15" data-row="2024.06" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="total-output-a" data-row="2024.06">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input input-15" data-row="2024.06" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-goods-15" data-row="2024.06" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input bad-debts" data-row="2024.06" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #ffe6cc;"><span class="total-input-b" data-row="2024.06">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #d4edda;">-</td>
                                <td style="border: 1px solid #ccc; padding: 4px; text-align: center; background: #fff3e0;"><input type="number" step="0.01" placeholder="0.00" class="soa-input" data-row="2024.06" style="width: 90%; border: 1px solid #ccc; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffebee;"><span class="difference" data-row="2024.06">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center; background: #f5f5f5;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                            </tr>
                            <tr data-period="2024.07">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600; text-align: center;">2024.07</td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input output-15" data-row="2024.07" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-output-15" data-row="2024.07" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="total-output-a" data-row="2024.07">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input input-15" data-row="2024.07" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-goods-15" data-row="2024.07" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input bad-debts" data-row="2024.07" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #ffe6cc;"><span class="total-input-b" data-row="2024.07">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #d4edda;">-</td>
                                <td style="border: 1px solid #ccc; padding: 4px; text-align: center; background: #fff3e0;"><input type="number" step="0.01" placeholder="0.00" class="soa-input" data-row="2024.07" style="width: 90%; border: 1px solid #ccc; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffebee;"><span class="difference" data-row="2024.07">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center; background: #f5f5f5;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                            </tr>
                            <tr data-period="2024.08">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600; text-align: center;">2024.08</td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input output-15" data-row="2024.08" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-output-15" data-row="2024.08" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="total-output-a" data-row="2024.08">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input input-15" data-row="2024.08" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input capital-goods-15" data-row="2024.08" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 4px; background: #ffe6cc;"><input type="number" step="0.01" placeholder="0.00" class="vat-input bad-debts" data-row="2024.08" style="width: 100%; border: none; padding: 4px; text-align: right; background: #ffe6cc;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #ffe6cc;"><span class="total-input-b" data-row="2024.08">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #d4edda;">-</td>
                                <td style="border: 1px solid #ccc; padding: 4px; text-align: center; background: #fff3e0;"><input type="number" step="0.01" placeholder="0.00" class="soa-input" data-row="2024.08" style="width: 90%; border: 1px solid #ccc; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffebee;"><span class="difference" data-row="2024.08">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center; background: #f5f5f5;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                            </tr>
                            <tr style="background: #f5f5f5; font-weight: 600;">
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;">Total</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffd9b3;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffd9b3;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffd9b3;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffd9b3;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffd9b3;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #c3e6cb; font-family: 'Courier New', monospace;">20.00</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #fff3e0; font-family: 'Courier New', monospace;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #ffebee; font-family: 'Courier New', monospace;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- INCOME Section -->
                <div style="margin-top: 30px; overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 30px;">
                        <thead>
                            <tr style="background: #e8eaed; font-weight: 600;">
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">INCOME</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2025.03</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.04</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.05</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.06</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.07</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.08</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.09</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.10</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.11</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.12</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2025.01</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2025.02</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border: 1px solid #ccc; padding: 8px;">According to VAT Report (Excl)</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="vat-report-income" data-period="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #f0f0f0; font-weight: 600;"><span class="vat-report-income" data-period="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-income" data-period="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-income" data-period="2024.06">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-income" data-period="2024.07">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-income" data-period="2024.08">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ccc; padding: 8px;">According to TB</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"><span class="tb-income-ref" data-period="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"><span class="tb-income-ref" data-period="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-income-ref" data-period="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-income-ref" data-period="2024.06">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-income-ref" data-period="2024.07">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-income-ref" data-period="2024.08">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                            </tr>
                            <tr style="background: #fff3e0;">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600;">Difference</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="income-diff" data-period="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="income-diff" data-period="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-diff" data-period="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-diff" data-period="2024.06">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-diff" data-period="2024.07">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-diff" data-period="2024.08">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ccc; padding: 8px;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 11px;"><span class="income-pct" data-period="2025.03">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 11px;"><span class="income-pct" data-period="2024.04">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 11px; background: #f0f0f0;"><span class="income-pct" data-period="2024.05">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2024.06">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2024.07">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2024.08">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2024.09">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2024.10">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2024.11">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2024.12">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2025.01">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="income-pct" data-period="2025.02">0.00%</span></td>
                            </tr>
                            <tr style="background: #f5f5f5;">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600;">Authorisation</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- EXPENSES Section -->
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 30px;">
                        <thead>
                            <tr style="background: #e8eaed; font-weight: 600;">
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">EXPENSES</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2025.03</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.04</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.05</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.06</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.07</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.08</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.09</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.10</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.11</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2024.12</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2025.01</th>
                                <th style="border: 1px solid #ccc; padding: 8px; text-align: center;">2025.02</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border: 1px solid #ccc; padding: 8px;">According to VAT Report (Excl)</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="vat-report-expense" data-period="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="vat-report-expense" data-period="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2024.06">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2024.07">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2024.08">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2024.09">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2024.10">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2024.11">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2024.12">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="vat-report-expense" data-period="2025.01">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #f0f0f0;"><span class="vat-report-expense" data-period="2025.02">0.00</span></td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ccc; padding: 8px;">According to TB</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"><span class="tb-expense-ref" data-period="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"><span class="tb-expense-ref" data-period="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2024.06">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2024.07">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2024.08">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2024.09">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2024.10">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2024.11">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2024.12">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="tb-expense-ref" data-period="2025.01">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; background: #f0f0f0;"><span class="tb-expense-ref" data-period="2025.02">0.00</span></td>
                            </tr>
                            <tr style="background: #fff3e0;">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600;">Difference</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="expense-diff" data-period="2025.03">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600;"><span class="expense-diff" data-period="2024.04">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-diff" data-period="2024.05">0.00</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">-</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; font-weight: 600; background: #f0f0f0;"><span class="expense-diff" data-period="2025.02">0.00</span></td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ccc; padding: 8px;"></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 11px;"><span class="expense-pct" data-period="2025.03">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-size: 11px;"><span class="expense-pct" data-period="2024.04">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 11px; background: #f0f0f0;"><span class="expense-pct" data-period="2024.05">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2024.06">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2024.07">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2024.08">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2024.09">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2024.10">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2024.11">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2024.12">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2025.01">0.00%</span></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: right;"><span class="expense-pct" data-period="2025.02">0.00%</span></td>
                            </tr>
                            <tr style="background: #f5f5f5;">
                                <td style="border: 1px solid #ccc; padding: 8px; font-weight: 600;">Authorisation</td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                                <td style="border: 1px solid #ccc; padding: 8px; text-align: center;"><button style="background: #4caf50; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px;">Authorize</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- PROEFBALANS Section -->
                <div style="overflow-x: auto;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                        <!-- INCOME PROEFBALANS -->
                        <div>
                            <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                                <thead>
                                    <tr style="background: #e8eaed;">
                                        <th style="border: 1px solid #ccc; padding: 8px; text-align: left; font-weight: 600;">INCOME</th>
                                        <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600;">Trial Balance</th>
                                        <th colspan="2" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #d4e3f7;">Excl. VAT amounts</th>
                                        <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600;">TOTAAL</th>
                                    </tr>
                                    <tr style="background: #f5f5f5;">
                                        <th style="border: 1px solid #ccc; padding: 6px;"></th>
                                        <th style="border: 1px solid #ccc; padding: 6px;"></th>
                                        <th style="border: 1px solid #ccc; padding: 6px; text-align: center; font-size: 11px;">VAT</th>
                                        <th style="border: 1px solid #ccc; padding: 6px; text-align: center; font-size: 11px;">NO VAT</th>
                                        <th style="border: 1px solid #ccc; padding: 6px;"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Sales</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">73,315.48</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="income-sales" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="income-sales" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="income-sales">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Sales 0%</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">33,330.30</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="income-sales0" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #ffe6e6;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="income-sales0" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6e6;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="income-sales0">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Sales 15%</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">1,752,750.13</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="income-sales15" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="income-sales15" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="income-sales15">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Interest Received</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">2.45</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="income-interest" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #ffe6e6;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="income-interest" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6e6;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="income-interest">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" style="border: none; padding: 8px;"></td>
                                    </tr>
                                    <tr style="background: #f5f5f5; font-weight: 600;">
                                        <td style="border: 1px solid #ccc; padding: 8px;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">1,872,058.36</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #d4e3f7;"><span class="tb-vat-total-income">0.00</span></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-novat-total-income">0.00</span></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-grand-total-income">0.00</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- EXPENSE PROEFBALANS -->
                        <div>
                            <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                                <thead>
                                    <tr style="background: #e8eaed;">
                                        <th style="border: 1px solid #ccc; padding: 8px; text-align: left; font-weight: 600;">EXPENSE</th>
                                        <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600;">Trial Balance</th>
                                        <th colspan="2" style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600; background: #d4e3f7;">Excl. VAT amounts</th>
                                        <th style="border: 1px solid #ccc; padding: 8px; text-align: center; font-weight: 600;">TOTAAL</th>
                                    </tr>
                                    <tr style="background: #f5f5f5;">
                                        <th style="border: 1px solid #ccc; padding: 6px;"></th>
                                        <th style="border: 1px solid #ccc; padding: 6px;"></th>
                                        <th style="border: 1px solid #ccc; padding: 6px; text-align: center; font-size: 11px;">VAT</th>
                                        <th style="border: 1px solid #ccc; padding: 6px; text-align: center; font-size: 11px;">NO VAT</th>
                                        <th style="border: 1px solid #ccc; padding: 6px;"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Purchases 15%</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">738,361.47</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-purchases15" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-purchases15" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-purchases15">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Purchases No VAT</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">512,154.50</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-purchasesnovat" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #ffe6e6;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-purchasesnovat" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6e6;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-purchasesnovat">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Accounting Fees</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">18,577.77</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-accounting" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #ffe6e6;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-accounting" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6e6;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-accounting">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Advertising</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">5,713.05</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-advertising" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-advertising" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-advertising">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Advertising No Vat</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">7,593.00</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-advertisingnovat" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #ffe6e6;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-advertisingnovat" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6e6;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-advertisingnovat">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Bank Charges</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">4,174.00</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-bankcharges" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-bankcharges" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-bankcharges">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Blomme</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">300.00</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-blomme" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #ffe6e6;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-blomme" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6e6;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-blomme">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Capitec commision and connect</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">7,253.48</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #fff59d;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-capitec" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #fff59d;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-capitec" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-capitec">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Cleaning</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">4,045.46</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-cleaning" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-cleaning" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-cleaning">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Computer Expenses</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">2,363.30</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-computer" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-computer" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-computer">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Diesel</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">15,280.00</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-diesel" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #ffe6e6;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-diesel" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6e6;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-diesel">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ccc; padding: 8px;">Directors Remuneration</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">51,000.00</td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #e3f2fd;"><input type="number" step="0.01" placeholder="0.00" class="tb-vat-input" data-row="expense-directors" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #e3f2fd;"></td>
                                        <td style="border: 1px solid #ccc; padding: 4px; text-align: right; background: #ffe6e6;"><input type="number" step="0.01" placeholder="0.00" class="tb-novat-input" data-row="expense-directors" style="width: 95%; border: 1px solid #ddd; padding: 4px; text-align: right; font-family: 'Courier New', monospace; background: #ffe6e6;"></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-total" data-row="expense-directors">0.00</span></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" style="border: none; padding: 8px;"></td>
                                    </tr>
                                    <tr style="background: #f5f5f5; font-weight: 600;">
                                        <td style="border: 1px solid #ccc; padding: 8px;">Total</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;">1,366,815.03</td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace; background: #d4e3f7;"><span class="tb-vat-total-expense">0.00</span></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-novat-total-expense">0.00</span></td>
                                        <td style="border: 1px solid #ccc; padding: 8px; text-align: right; font-family: 'Courier New', monospace;"><span class="tb-grand-total-expense">0.00</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div style="background: white; border: 2px solid #0066cc; border-radius: 10px; padding: 25px; margin: 30px 0;">
                    <div style="display: flex; gap: 12px; justify-content: flex-end;">
                        <button class="btn-secondary" onclick="saveDraftReconciliation()">Save Draft</button>
                        <button class="btn-secondary" onclick="approveReconciliation()">Approve Reconciliation</button>
                        <button class="btn-primary" onclick="submitToSARS()">Submit to SARS</button>
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #0066cc 0%, #0099ff 100%); color: white; padding: 25px; border-radius: 10px; margin-bottom: 25px;">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; text-align: center;">
                        <div>
                            <div style="font-size: 13px; opacity: 0.9; margin-bottom: 5px;">Output VAT</div>
                            <div style="font-size: 24px; font-weight: 700;">R 34,102.83</div>
                        </div>
                        <div style="border-left: 1px solid rgba(255,255,255,0.3); border-right: 1px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 13px; opacity: 0.9; margin-bottom: 5px;">Input VAT</div>
                            <div style="font-size: 24px; font-weight: 700;">R 17,145.00</div>
                        </div>
                        <div>
                            <div style="font-size: 13px; opacity: 0.9; margin-bottom: 5px;">VAT Payable</div>
                            <div style="font-size: 24px; font-weight: 700;">R 16,957.83</div>
                        </div>
                    </div>
                </div>

                <div style="background: #fff3e0; border: 1px solid #ffb74d; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 24px;">⚠️</span>
                        <div>
                            <div style="font-weight: 600; color: #ef6c00; margin-bottom: 4px;">Reconciliation Status</div>
                            <div style="font-size: 14px; color: #e65100;">Please verify all transactions before submitting. Ensure all invoices and expenses are captured.</div>
                        </div>
                    </div>
                </div>

                <div style="background: white; border: 1px solid #e8eaed; border-radius: 8px; padding: 20px;">
                    <h4 style="font-size: 15px; font-weight: 600; margin-bottom: 15px; color: #202124;">Reconciliation Checklist</h4>
                    <div style="display: grid; gap: 12px;">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; border-radius: 6px; transition: background 0.2s;" onmouseover="this.style.background='rgba(0,102,204,0.05)'" onmouseout="this.style.background='white'">
                            <input type="checkbox" id="check1" onchange="updateReconStatus()">
                            <span style="font-size: 14px;">All sales invoices have been captured and reviewed</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; border-radius: 6px; transition: background 0.2s;" onmouseover="this.style.background='rgba(0,102,204,0.05)'" onmouseout="this.style.background='white'">
                            <input type="checkbox" id="check2" onchange="updateReconStatus()">
                            <span style="font-size: 14px;">All purchase invoices and expenses have been recorded</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; border-radius: 6px; transition: background 0.2s;" onmouseover="this.style.background='rgba(0,102,204,0.05)'" onmouseout="this.style.background='white'">
                            <input type="checkbox" id="check3" onchange="updateReconStatus()">
                            <span style="font-size: 14px;">Bank reconciliation has been completed</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; border-radius: 6px; transition: background 0.2s;" onmouseover="this.style.background='rgba(0,102,204,0.05)'" onmouseout="this.style.background='white'">
                            <input type="checkbox" id="check4" onchange="updateReconStatus()">
                            <span style="font-size: 14px;">All VAT amounts have been verified against source documents</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; border-radius: 6px; transition: background 0.2s;" onmouseover="this.style.background='rgba(0,102,204,0.05)'" onmouseout="this.style.background='white'">
                            <input type="checkbox" id="check5" onchange="updateReconStatus()">
                            <span style="font-size: 14px;">Zero-rated and exempt supplies have been correctly classified</span>
                        </label>
                    </div>
                    
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e8eaed; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div id="reconStatus" style="font-size: 14px; font-weight: 600; color: #ef6c00;">Reconciliation Incomplete (0/5 checks)</div>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <button class="btn-secondary" onclick="closeVATRecon()">Close</button>
                            <button class="btn-primary" id="completeReconBtn" disabled onclick="completeReconciliation()" style="opacity: 0.5; cursor: not-allowed;">Mark as Reconciled</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="report-card">
            <div class="report-header">
                <h2>VAT Submission History</h2>
                <p>Recent VAT201 submissions</p>
            </div>
            
            <div class="report-content">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Period</th>
                            <th>Submission Date</th>
                            <th class="amount">Output VAT</th>
                            <th class="amount">Input VAT</th>
                            <th class="amount">Net VAT</th>
                            <th class="amount">Payment Date</th>
                            <th>Status</th>
                            <th>Reconciliation</th>
                            <th>VAT Report</th>
                        </tr>
                    </thead>
                    <tbody id="vatSubmissionHistoryBody">
                        <tr>
                            <td>January 2026</td>
                            <td>-</td>
                            <td class="amount">R 34,102.83</td>
                            <td class="amount">R 17,145.00</td>
                            <td class="amount">R 16,957.83</td>
                            <td class="amount">-</td>
                            <td><span class="status-badge status-pending">Pending</span></td>
                            <td><button class="btn-link" onclick="viewReconciliation('2026.01')" disabled>N/A</button></td>
                            <td><button class="btn-link" onclick="viewVATReport('2026.01')" disabled>N/A</button></td>
                        </tr>
                        <tr>
                            <td>December 2025</td>
                            <td>15 Jan 2026</td>
                            <td class="amount">R 31,450.00</td>
                            <td class="amount">R 15,820.00</td>
                            <td class="amount">R 15,630.00</td>
                            <td class="amount">20 Jan 2026</td>
                            <td><span class="status-badge status-submitted">Submitted</span></td>
                            <td><button class="btn-link" onclick="viewReconciliation('2025.12')">View</button></td>
                            <td><button class="btn-link" onclick="viewVATReport('2025.12')">View</button></td>
                        </tr>
                        <tr>
                            <td>November 2025</td>
                            <td>12 Dec 2025</td>
                            <td class="amount">R 29,800.00</td>
                            <td class="amount">R 14,200.00</td>
                            <td class="amount">R 15,600.00</td>
                            <td class="amount">18 Dec 2025</td>
                            <td><span class="status-badge status-submitted">Submitted</span></td>
                            <td><button class="btn-link" onclick="viewReconciliation('2025.11')">View</button></td>
                            <td><button class="btn-link" onclick="viewVATReport('2025.11')">View</button></td>
                        </tr>
                        <tr>
                            <td>October 2025</td>
                            <td>10 Nov 2025</td>
                            <td class="amount">R 32,100.00</td>
                            <td class="amount">R 16,500.00</td>
                            <td class="amount">R 15,600.00</td>
                            <td class="amount">15 Nov 2025</td>
                            <td><span class="status-badge status-submitted">Submitted</span></td>
                            <td><button class="btn-link" onclick="viewReconciliation('2025.10')">View</button></td>
                            <td><button class="btn-link" onclick="viewVATReport('2025.10')">View</button></td>
                        </tr>
                        <tr>
                            <td>September 2025</td>
                            <td>08 Oct 2025</td>
                            <td class="amount">R 28,900.00</td>
                            <td class="amount">R 13,800.00</td>
                            <td class="amount">R 15,100.00</td>
                            <td class="amount">12 Oct 2025</td>
                            <td><span class="status-badge status-submitted">Submitted</span></td>
                            <td><button class="btn-link" onclick="viewReconciliation('2025.09')">View</button></td>
                            <td><button class="btn-link" onclick="viewVATReport('2025.09')">View</button></td>
                        </tr>
                        <tr>
                            <td>August 2025</td>
                            <td>10 Sep 2025</td>
                            <td class="amount">R 30,200.00</td>
                            <td class="amount">R 14,900.00</td>
                            <td class="amount">R 15,300.00</td>
                            <td class="amount">14 Sep 2025</td>
                            <td><span class="status-badge status-submitted">Submitted</span></td>
                            <td><button class="btn-link" onclick="viewReconciliation('2025.08')">View</button></td>
                            <td><button class="btn-link" onclick="viewVATReport('2025.08')">View</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        // Auto-login for demo mode
        let token = localStorage.getItem('token');
        let user = JSON.parse(localStorage.getItem('user') || '{}');
        
        if (!token) {
            const mockUser = {
                id: 1,
                email: 'demo@lorenco.com',
                firstName: 'Demo',
                lastName: 'User',
                role: 'admin',
                companyId: 1,
                companyName: 'Demo Company Ltd',
                companyStatus: 'active'
            };
            
            token = 'demo-token-' + Date.now();
            localStorage.setItem('token', token);
            localStorage.setItem('user', JSON.stringify(mockUser));
            localStorage.setItem('demoMode', 'true');
            user = mockUser;
        }
        
        // User info display and logout handled by navigation.js
        
        function viewReturn() {
            window.location.href = 'vat-return.html';
        }
        
        function submitReturn() {
            alert('This would submit the VAT return to SARS eFiling system...');
        }
        
        function makePayment() {
            alert('This would redirect to SARS eFiling payment portal...');
        }

        function openVATRecon() {
            const section = document.getElementById('vatReconSection');
            if (section.style.display === 'none') {
                section.style.display = 'block';
                section.scrollIntoView({ behavior: 'smooth' });
            } else {
                section.style.display = 'none';
            }
        }

        function closeVATRecon() {
            document.getElementById('vatReconSection').style.display = 'none';
        }

        function updateReconStatus() {
            const checks = [
                document.getElementById('check1'),
                document.getElementById('check2'),
                document.getElementById('check3'),
                document.getElementById('check4'),
                document.getElementById('check5')
            ];
            
            const completed = checks.filter(check => check.checked).length;
            const total = checks.length;
            const statusDiv = document.getElementById('reconStatus');
            const completeBtn = document.getElementById('completeReconBtn');
            
            if (completed === total) {
                statusDiv.textContent = `Reconciliation Complete (${completed}/${total} checks)`;
                statusDiv.style.color = '#2e7d32';
                completeBtn.disabled = false;
                completeBtn.style.opacity = '1';
                completeBtn.style.cursor = 'pointer';
            } else {
                statusDiv.textContent = `Reconciliation Incomplete (${completed}/${total} checks)`;
                statusDiv.style.color = '#ef6c00';
                completeBtn.disabled = true;
                completeBtn.style.opacity = '0.5';
                completeBtn.style.cursor = 'not-allowed';
            }
        }

        function completeReconciliation() {
            if (confirm('Are you sure you want to mark this VAT period as reconciled?\n\nThis will lock the period and prepare it for submission.')) {
                alert('✓ VAT Reconciliation completed successfully!\n\nYou can now proceed to submit your VAT return to SARS.');
                closeVATRecon();
            }
        }

        // Load VAT data from journals and populate reconciliation table
        function loadVATReconData() {
            // Get journal entries from localStorage
            const journals = JSON.parse(localStorage.getItem('journals') || '[]');
            
            // Initialize data structure for VAT periods
            const vatPeriods = {
                '2025.03': { incInc115: 0, incOut15: 0, capGoods15: 0, capOut15: 0, zeroRate: 0, expInc115: 0, expIn15: 0, capGoodsIn15: 0, badDebts: 0 },
                '2024.04': { incInc115: 0, incOut15: 0, capGoods15: 0, capOut15: 0, zeroRate: 0, expInc115: 0, expIn15: 0, capGoodsIn15: 0, badDebts: 0 },
                '2024.05': { incInc115: 0, incOut15: 0, capGoods15: 0, capOut15: 0, zeroRate: 0, expInc115: 0, expIn15: 0, capGoodsIn15: 0, badDebts: 0 },
                '2024.06': { incInc115: 0, incOut15: 0, capGoods15: 0, capOut15: 0, zeroRate: 0, expInc115: 0, expIn15: 0, capGoodsIn15: 0, badDebts: 0 },
                '2024.07': { incInc115: 0, incOut15: 0, capGoods15: 0, capOut15: 0, zeroRate: 0, expInc115: 0, expIn15: 0, capGoodsIn15: 0, badDebts: 0 },
                '2024.08': { incInc115: 0, incOut15: 0, capGoods15: 0, capOut15: 0, zeroRate: 0, expInc115: 0, expIn15: 0, capGoodsIn15: 0, badDebts: 0 }
            };

            // Process journal entries
            journals.forEach(journal => {
                const date = new Date(journal.date);
                const period = `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}`;
                
                if (vatPeriods[period]) {
                    journal.entries?.forEach(entry => {
                        const amount = parseFloat(entry.credit || entry.debit || 0);
                        const vatCode = entry.vatCode || '';
                        
                        // Income (Output) VAT
                        if (vatCode === 'Output 15%' || vatCode === 'Sales 15%') {
                            vatPeriods[period].incInc115 += amount * 1.15; // Inclusive
                            vatPeriods[period].incOut15 += amount * 0.15; // VAT portion
                        } else if (vatCode === 'Zero Rate' || vatCode === 'Sales 0%') {
                            vatPeriods[period].zeroRate += amount;
                        }
                        
                        // Expense (Input) VAT
                        else if (vatCode === 'Input 15%' || vatCode === 'Purchases 15%') {
                            vatPeriods[period].expInc115 += amount * 1.15; // Inclusive
                            vatPeriods[period].expIn15 += amount * 0.15; // VAT portion
                        } else if (vatCode === 'Capital Goods 15%') {
                            vatPeriods[period].capGoodsIn15 += amount * 0.15;
                        } else if (vatCode === 'Bad Debts') {
                            vatPeriods[period].badDebts += amount * 0.15;
                        }
                    });
                }
            });

            // Update table with calculated values
            updateVATReconTable(vatPeriods);
        }

        function updateVATReconTable(vatPeriods) {
            const tbody = document.querySelector('#vatReconTable tbody');
            if (!tbody) return;

            // Clear existing rows except header and total
            const rows = tbody.querySelectorAll('tr');
            rows.forEach((row, index) => {
                if (index === rows.length - 1) return; // Skip total row
                
                const cells = row.cells;
                const period = cells[1]?.textContent.trim();
                
                if (vatPeriods[period]) {
                    const data = vatPeriods[period];
                    
                    // Calculate totals
                    const totalOutput = data.incOut15 + data.capOut15 + data.zeroRate;
                    const totalInput = data.expIn15 + data.capGoodsIn15 + data.badDebts;
                    const vatPayable = totalOutput - totalInput;
                    
                    // Update cells
                    cells[2].textContent = formatAmount(data.incInc115);
                    cells[3].textContent = formatAmount(data.incOut15);
                    cells[4].textContent = formatAmount(data.capGoods15);
                    cells[5].textContent = formatAmount(data.capOut15);
                    cells[6].textContent = formatAmount(data.zeroRate);
                    cells[7].textContent = formatAmount(totalOutput);
                    cells[8].textContent = formatAmount(data.expInc115);
                    cells[9].textContent = formatAmount(data.expIn15);
                    cells[10].textContent = formatAmount(data.capGoodsIn15);
                    cells[11].textContent = formatAmount(data.badDebts);
                    cells[12].textContent = formatAmount(totalInput);
                    cells[13].textContent = formatAmount(vatPayable);
                }
            });
        }

        function formatAmount(amount) {
            if (amount === 0) return '-';
            return new Intl.NumberFormat('en-ZA', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(Math.abs(amount));
        }

        // Load data when VAT Recon is opened
        const originalOpenVATRecon = openVATRecon;
        openVATRecon = function() {
            originalOpenVATRecon();
            loadVATReconData();
        };

        // Load on page load
        window.addEventListener('DOMContentLoaded', () => {
            loadVATReconData();
            loadVATSubmissionHistory();
        });

        // ========================================================
        // VAT RECONCILIATION API INTEGRATION
        // ========================================================

        const API_BASE = window.location.origin + '/api';
        let currentReconId = null;
        let currentPeriodData = null;

        async function fetchAPI(endpoint, options = {}) {
            const token = localStorage.getItem('token');
            const headers = {
                'Content-Type': 'application/json',
                ...(token && { 'Authorization': `Bearer ${token}` })
            };

            const response = await fetch(`${API_BASE}${endpoint}`, {
                ...options,
                headers: { ...headers, ...options.headers }
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error || 'API request failed');
            }

            return response.json();
        }

        // Period selector and reconciliation workflow
        async function selectVATPeriod() {
            const periodKey = document.getElementById('periodSelect')?.value;
            if (!periodKey) return;

            try {
                // Create or get period
                const periodData = parsePeriodKey(periodKey);
                const result = await fetchAPI('/vat-recon/periods', {
                    method: 'POST',
                    body: JSON.stringify(periodData)
                });

                currentPeriodData = result.period;

                // Load reconciliation for this period
                await loadReconciliationForPeriod(periodKey);
                
                // Load Trial Balance data
                await loadTrialBalanceForPeriod(currentPeriodData.from_date, currentPeriodData.to_date);

            } catch (error) {
                console.error('Error selecting VAT period:', error);
                alert('Error loading VAT period: ' + error.message);
            }
        }

        function parsePeriodKey(periodKey) {
            // Parse "2025.03" format
            const [year, month] = periodKey.split('.');
            const fromDate = new Date(year, parseInt(month) - 1, 1);
            const toDate = new Date(year, parseInt(month), 0); // Last day of month

            return {
                periodKey,
                fromDate: fromDate.toISOString().split('T')[0],
                toDate: toDate.toISOString().split('T')[0],
                filingFrequency: 'monthly'
            };
        }

        async function loadReconciliationForPeriod(periodKey) {
            try {
                const result = await fetchAPI(`/vat-recon/reconciliations/period/${periodKey}`);
                if (result.success && result.reconciliation) {
                    currentReconId = result.reconciliation.id;
                    populateReconciliationData(result.reconciliation);
                }
            } catch (error) {
                console.log('No existing reconciliation found, will create new draft');
                currentReconId = null;
            }
        }

        async function loadTrialBalanceForPeriod(fromDate, toDate) {
            try {
                const result = await fetchAPI(`/vat-recon/trial-balance?fromDate=${fromDate}&toDate=${toDate}`);
                if (result.success) {
                    populateTrialBalanceData(result.trialBalance);
                }
            } catch (error) {
                console.error('Error loading trial balance:', error);
            }
        }

        function populateTrialBalanceData(trialBalance) {
            // TODO: Populate trial balance section with actual TB data
            console.log('Trial Balance data:', trialBalance);
        }

        function populateReconciliationData(recon) {
            // Populate authorization checkboxes and initials
            if (recon.diff_authorized) {
                const authCheckbox = document.getElementById('diffAuthCheckbox');
                if (authCheckbox) {
                    authCheckbox.checked = true;
                    authCheckbox.disabled = recon.status === 'LOCKED';
                    displayAuthInitials('diffAuthInitials', recon.diff_authorized_by_initials);
                }
            }

            if (recon.soa_authorized) {
                const soaAuthCheckbox = document.getElementById('soaAuthCheckbox');
                if (soaAuthCheckbox) {
                    soaAuthCheckbox.checked = true;
                    soaAuthCheckbox.disabled = recon.status === 'LOCKED';
                    displayAuthInitials('soaAuthInitials', recon.soa_authorized_by_initials);
                }
            }

            // Populate SOA amount
            if (recon.soa_amount) {
                const soaInput = document.getElementById('soaAmount');
                if (soaInput) {
                    soaInput.value = recon.soa_amount;
                    soaInput.disabled = recon.status === 'LOCKED';
                }
            }

            // Set read-only mode if locked
            if (recon.status === 'LOCKED') {
                setReconciliationReadOnly();
            }
        }

        function displayAuthInitials(elementId, initials) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = `Authorized by: ${initials}`;
                element.style.display = 'inline';
                element.style.marginLeft = '10px';
                element.style.color = '#2e7d32';
                element.style.fontWeight = '600';
            }
        }

        function setReconciliationReadOnly() {
            // Disable all inputs and buttons
            const inputs = document.querySelectorAll('#vatReconSection input, #vatReconSection button');
            inputs.forEach(input => {
                if (!input.classList.contains('view-only-btn')) {
                    input.disabled = true;
                }
            });

            // Show locked message
            const header = document.querySelector('#vatReconSection .report-header h2');
            if (header) {
                header.innerHTML += ' <span style="color: #d32f2f; margin-left: 15px;">🔒 LOCKED</span>';
            }
        }

        async function saveDraftReconciliation() {
            if (!currentPeriodData) {
                alert('Please select a VAT period first');
                return;
            }

            try {
                const reconData = {
                    vatPeriodId: currentPeriodData.id,
                    soaAmount: document.getElementById('soaAmount')?.value || null,
                    lines: [], // TODO: Collect line items from table
                    metadata: {}
                };

                const result = await fetchAPI('/vat-recon/reconciliations/draft', {
                    method: 'POST',
                    body: JSON.stringify(reconData)
                });

                if (result.success) {
                    currentReconId = result.reconciliation.id;
                    alert('✓ Reconciliation draft saved successfully');
                }
            } catch (error) {
                console.error('Error saving draft:', error);
                alert('Error saving draft: ' + error.message);
            }
        }

        async function authorizeDifference() {
            if (!currentReconId) {
                alert('Please save the reconciliation first');
                return;
            }

            try {
                const result = await fetchAPI(`/vat-recon/reconciliations/${currentReconId}/authorize-difference`, {
                    method: 'POST'
                });

                if (result.success) {
                    document.getElementById('diffAuthCheckbox').checked = true;
                    displayAuthInitials('diffAuthInitials', result.reconciliation.diff_authorized_by_initials);
                    alert('✓ Income/Expense difference authorized');
                }
            } catch (error) {
                console.error('Error authorizing difference:', error);
                alert('Error: ' + error.message);
            }
        }

        async function authorizeSOADifference() {
            if (!currentReconId) {
                alert('Please save the reconciliation first');
                return;
            }

            try {
                const result = await fetchAPI(`/vat-recon/reconciliations/${currentReconId}/authorize-soa`, {
                    method: 'POST'
                });

                if (result.success) {
                    document.getElementById('soaAuthCheckbox').checked = true;
                    displayAuthInitials('soaAuthInitials', result.reconciliation.soa_authorized_by_initials);
                    alert('✓ Statement of Account difference authorized');
                }
            } catch (error) {
                console.error('Error authorizing SOA difference:', error);
                alert('Error: ' + error.message);
            }
        }

        // Handler for Income/Expense difference authorization checkbox
        function handleDiffAuthChange() {
            const checkbox = document.getElementById('diffAuthCheckbox');
            if (checkbox.checked) {
                authorizeDifference();
            } else {
                checkbox.checked = false; // Cannot uncheck - authorization is permanent
                alert('Authorization cannot be removed once granted');
            }
        }

        // Handler for SOA difference authorization checkbox
        function handleSOAAuthChange() {
            const checkbox = document.getElementById('soaAuthCheckbox');
            if (checkbox.checked) {
                authorizeSOADifference();
            } else {
                checkbox.checked = false; // Cannot uncheck - authorization is permanent
                alert('Authorization cannot be removed once granted');
            }
        }

        // Calculate difference between Net VAT and Statement of Account
        function calculateSOADifference() {
            const soaAmount = parseFloat(document.getElementById('soaAmount').value) || 0;
            const netVat = parseFloat(document.getElementById('netVat').innerText.replace(/[^0-9.-]/g, '')) || 0;
            
            const difference = netVat - soaAmount;
            
            const diffDisplay = document.getElementById('soaDifferenceDisplay');
            const diffValue = document.getElementById('soaDifferenceValue');
            
            if (diffValue) {
                diffValue.innerText = formatAmount(Math.abs(difference));
                
                if (difference > 0) {
                    diffDisplay.style.color = '#d32f2f'; // Red - we owe more
                    diffValue.innerText = formatAmount(difference) + ' MORE than SOA';
                } else if (difference < 0) {
                    diffDisplay.style.color = '#388e3c'; // Green - SOA shows more
                    diffValue.innerText = formatAmount(Math.abs(difference)) + ' LESS than SOA';
                } else {
                    diffDisplay.style.color = '#1976d2'; // Blue - perfect match
                    diffValue.innerText = 'MATCH ✓';
                }
            }
        }

        async function approveReconciliation() {
            if (!currentReconId) {
                alert('Please save the reconciliation first');
                return;
            }

            if (!confirm('Are you sure you want to approve this reconciliation?\n\nOnce approved, it can be submitted to SARS.')) {
                return;
            }

            try {
                const result = await fetchAPI(`/vat-recon/reconciliations/${currentReconId}/approve`, {
                    method: 'POST'
                });

                if (result.success) {
                    alert('✓ Reconciliation approved successfully');
                    await loadReconciliationForPeriod(currentPeriodData.period_key);
                }
            } catch (error) {
                console.error('Error approving reconciliation:', error);
                alert('Error: ' + error.message);
            }
        }

        async function submitToSARS() {
            if (!currentPeriodData) {
                alert('Please select a VAT period first');
                return;
            }

            if (!confirm('⚠️ IMPORTANT: Submit to SARS?\n\nThis will LOCK the reconciliation and VAT report for this period.\nNo further changes will be allowed.\n\nContinue?')) {
                return;
            }

            const submissionRef = prompt('Enter SARS submission reference (optional):');
            
            try {
                const submissionData = {
                    outputVat: 0, // TODO: Get from reconciliation
                    inputVat: 0,
                    netVat: 0,
                    submissionReference: submissionRef,
                    paymentDate: null,
                    paymentReference: null
                };

                const result = await fetchAPI(`/vat-recon/periods/${currentPeriodData.id}/submit`, {
                    method: 'POST',
                    body: JSON.stringify(submissionData)
                });

                if (result.success) {
                    alert('✓ Successfully submitted to SARS!\n\nPeriod is now LOCKED.');
                    await loadVATSubmissionHistory();
                    setReconciliationReadOnly();
                }
            } catch (error) {
                console.error('Error submitting to SARS:', error);
                alert('Error: ' + error.message);
            }
        }

        async function loadVATSubmissionHistory() {
            try {
                const result = await fetchAPI('/vat-recon/submissions');
                if (result.success && result.submissions) {
                    populateSubmissionHistoryTable(result.submissions);
                }
            } catch (error) {
                console.error('Error loading submission history:', error);
            }
        }

        function populateSubmissionHistoryTable(submissions) {
            const tbody = document.getElementById('vatSubmissionHistoryBody');
            if (!tbody || submissions.length === 0) return;

            tbody.innerHTML = submissions.map(sub => `
                <tr>
                    <td>${formatPeriodDisplay(sub.period_key)}</td>
                    <td>${sub.submission_date ? formatDate(sub.submission_date) : '-'}</td>
                    <td class="amount">R ${formatAmount(sub.output_vat)}</td>
                    <td class="amount">R ${formatAmount(sub.input_vat)}</td>
                    <td class="amount">R ${formatAmount(sub.net_vat)}</td>
                    <td class="amount">${sub.payment_date ? formatDate(sub.payment_date) : '-'}</td>
                    <td><span class="status-badge status-${sub.status.toLowerCase()}">${sub.status}</span></td>
                    <td>
                        ${sub.reconciliation_id 
                            ? `<button class="btn-link" onclick="viewReconciliation('${sub.period_key}')">View</button>`
                            : `<button class="btn-link" disabled>N/A</button>`
                        }
                    </td>
                    <td>
                        ${sub.vat_report_id 
                            ? `<button class="btn-link" onclick="viewVATReport('${sub.period_key}')">View</button>`
                            : `<button class="btn-link" disabled>N/A</button>`
                        }
                    </td>
                </tr>
            `).join('');
        }

        function formatPeriodDisplay(periodKey) {
            const [year, month] = periodKey.split('.');
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            return `${monthNames[parseInt(month) - 1]} ${year}`;
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-ZA', { day: '2-digit', month: 'short', year: 'numeric' });
        }

        async function viewReconciliation(periodKey) {
            try {
                const result = await fetchAPI(`/vat-recon/reconciliations/period/${periodKey}`);
                if (result.success && result.reconciliation) {
                    currentReconId = result.reconciliation.id;
                    currentPeriodData = { period_key: periodKey };
                    
                    // Open recon section and populate with data
                    openVATRecon();
                    populateReconciliationData(result.reconciliation);
                }
            } catch (error) {
                console.error('Error viewing reconciliation:', error);
                alert('Error loading reconciliation: ' + error.message);
            }
        }

        async function viewVATReport(periodKey) {
            // TODO: Implement VAT report viewer
            alert(`VAT Report for ${formatPeriodDisplay(periodKey)}\n\nFeature coming soon...`);
        }

        // Auto-calculate Total Output (A) = Output 15% + Capital Goods Output 15%
        // Auto-calculate Total Input (B) = Input 15% + Capital Goods 15% + Bad Debts
        // Auto-calculate VAT Payable = Total Output (A) - Total Input (B)
        // Auto-calculate Difference = VAT Payable - Statement of Account
        function setupAutoCalculations() {
            // Add event listeners to all income/output inputs
            document.querySelectorAll('.output-15, .capital-output-15').forEach(input => {
                input.addEventListener('input', function() {
                    const periodKey = this.getAttribute('data-row');
                    calculateTotalOutputA(periodKey);
                    calculateVATPayable(periodKey);
                    calculateDifference(periodKey);
                    updateReconciliationComparison();
                });
            });

            // Add event listeners to all expense/input inputs
            document.querySelectorAll('.input-15, .capital-goods-15, .bad-debts').forEach(input => {
                input.addEventListener('input', function() {
                    const periodKey = this.getAttribute('data-row');
                    calculateTotalInputB(periodKey);
                    calculateVATPayable(periodKey);
                    calculateDifference(periodKey);
                    updateReconciliationComparison();
                });
            });

            // Add event listeners to Statement of Account inputs
            document.querySelectorAll('.soa-input').forEach(input => {
                input.addEventListener('input', function() {
                    const periodKey = this.getAttribute('data-row');
                    calculateDifference(periodKey);
                });
            });

            // Add event listeners to ALL vat-input fields for reconciliation comparison
            document.querySelectorAll('input.vat-input').forEach(input => {
                input.addEventListener('input', function() {
                    updateReconciliationComparison();
                });
            });
        }

        function calculateTotalOutputA(periodKey) {
            const row = document.querySelector(`tr[data-period="${periodKey}"]`);
            if (!row) return;

            const output15Input = row.querySelector('.output-15');
            const capitalOutput15Input = row.querySelector('.capital-output-15');
            const totalOutputSpan = row.querySelector('.total-output-a');

            if (!output15Input || !capitalOutput15Input || !totalOutputSpan) return;

            const output15 = parseFloat(output15Input.value) || 0;
            const capitalOutput15 = parseFloat(capitalOutput15Input.value) || 0;
            const total = output15 + capitalOutput15;

            totalOutputSpan.textContent = total.toFixed(2);
            return total;
        }

        function calculateTotalInputB(periodKey) {
            const row = document.querySelector(`tr[data-period="${periodKey}"]`);
            if (!row) return;

            const input15Input = row.querySelector('.input-15');
            const capitalGoods15Input = row.querySelector('.capital-goods-15');
            const badDebtsInput = row.querySelector('.bad-debts');
            const totalInputSpan = row.querySelector('.total-input-b');

            if (!input15Input || !capitalGoods15Input || !badDebtsInput || !totalInputSpan) return;

            const input15 = parseFloat(input15Input.value) || 0;
            const capitalGoods15 = parseFloat(capitalGoods15Input.value) || 0;
            const badDebts = parseFloat(badDebtsInput.value) || 0;
            const total = input15 + capitalGoods15 + badDebts;

            totalInputSpan.textContent = total.toFixed(2);
            return total;
        }

        function calculateVATPayable(periodKey) {
            const row = document.querySelector(`tr[data-period="${periodKey}"]`);
            if (!row) return;

            const totalOutputSpan = row.querySelector('.total-output-a');
            const totalInputSpan = row.querySelector('.total-input-b');
            const vatPayableSpan = row.querySelector('.vat-payable');

            if (!totalOutputSpan || !totalInputSpan || !vatPayableSpan) return;

            const totalOutput = parseFloat(totalOutputSpan.textContent) || 0;
            const totalInput = parseFloat(totalInputSpan.textContent) || 0;
            const vatPayable = totalOutput - totalInput;

            vatPayableSpan.textContent = vatPayable.toFixed(2);
        }

        function calculateDifference(periodKey) {
            const row = document.querySelector(`tr[data-period="${periodKey}"]`);
            if (!row) return;

            const vatPayableSpan = row.querySelector('.vat-payable');
            const soaInput = row.querySelector('.soa-input');
            const differenceSpan = row.querySelector('.difference');

            if (!vatPayableSpan || !soaInput || !differenceSpan) return;

            const vatPayable = parseFloat(vatPayableSpan.textContent) || 0;
            const soa = parseFloat(soaInput.value) || 0;
            const difference = vatPayable - soa;

            differenceSpan.textContent = difference.toFixed(2);
        }

        // Initialize calculations when page loads
        window.addEventListener('DOMContentLoaded', function() {
            setupAutoCalculations();
            setupTrialBalanceCalculations();
        });

        // Trial Balance calculations: TOTAAL = VAT + NO VAT
        function setupTrialBalanceCalculations() {
            // Add event listeners to all trial balance inputs
            document.querySelectorAll('.tb-vat-input, .tb-novat-input').forEach(input => {
                input.addEventListener('input', function() {
                    const rowKey = this.getAttribute('data-row');
                    calculateTrialBalanceTotal(rowKey);
                    calculateTrialBalanceTotals();
                });
            });
        }

        function calculateTrialBalanceTotal(rowKey) {
            const vatInput = document.querySelector(`.tb-vat-input[data-row="${rowKey}"]`);
            const novatInput = document.querySelector(`.tb-novat-input[data-row="${rowKey}"]`);
            const totalSpan = document.querySelector(`.tb-total[data-row="${rowKey}"]`);

            if (!vatInput || !novatInput || !totalSpan) return;

            const vat = parseFloat(vatInput.value) || 0;
            const novat = parseFloat(novatInput.value) || 0;
            const total = vat + novat;

            totalSpan.textContent = total.toFixed(2);
        }

        function calculateTrialBalanceTotals() {
            // Calculate INCOME totals
            let incomeVatTotal = 0;
            let incomeNovatTotal = 0;
            document.querySelectorAll('.tb-vat-input[data-row^="income-"]').forEach(input => {
                incomeVatTotal += parseFloat(input.value) || 0;
            });
            document.querySelectorAll('.tb-novat-input[data-row^="income-"]').forEach(input => {
                incomeNovatTotal += parseFloat(input.value) || 0;
            });

            const incomeVatSpan = document.querySelector('.tb-vat-total-income');
            const incomeNovatSpan = document.querySelector('.tb-novat-total-income');
            const incomeGrandSpan = document.querySelector('.tb-grand-total-income');
            
            if (incomeVatSpan) incomeVatSpan.textContent = incomeVatTotal.toFixed(2);
            if (incomeNovatSpan) incomeNovatSpan.textContent = incomeNovatTotal.toFixed(2);
            if (incomeGrandSpan) incomeGrandSpan.textContent = (incomeVatTotal + incomeNovatTotal).toFixed(2);

            // Calculate EXPENSE totals
            let expenseVatTotal = 0;
            let expenseNovatTotal = 0;
            document.querySelectorAll('.tb-vat-input[data-row^="expense-"]').forEach(input => {
                expenseVatTotal += parseFloat(input.value) || 0;
            });
            document.querySelectorAll('.tb-novat-input[data-row^="expense-"]').forEach(input => {
                expenseNovatTotal += parseFloat(input.value) || 0;
            });

            const expenseVatSpan = document.querySelector('.tb-vat-total-expense');
            const expenseNovatSpan = document.querySelector('.tb-novat-total-expense');
            const expenseGrandSpan = document.querySelector('.tb-grand-total-expense');
            
            if (expenseVatSpan) expenseVatSpan.textContent = expenseVatTotal.toFixed(2);
            if (expenseNovatSpan) expenseNovatSpan.textContent = expenseNovatTotal.toFixed(2);
            if (expenseGrandSpan) expenseGrandSpan.textContent = (expenseVatTotal + expenseNovatTotal).toFixed(2);

            // Update reconciliation comparison "According to TB" values
            updateReconciliationComparison();
        }

        // Update reconciliation comparison section
        function updateReconciliationComparison() {
            // For now, we'll use the current period's TB totals for all periods
            // In a real implementation, you'd have period-specific TB values
            
            // Get TB totals
            const incomeVatTotal = parseFloat(document.querySelector('.tb-vat-total-income')?.textContent) || 0;
            const expenseVatTotal = parseFloat(document.querySelector('.tb-vat-total-expense')?.textContent) || 0;

            // Update "According to TB" for all periods
            document.querySelectorAll('.tb-income-ref').forEach(span => {
                span.textContent = incomeVatTotal.toFixed(2);
            });
            document.querySelectorAll('.tb-expense-ref').forEach(span => {
                span.textContent = expenseVatTotal.toFixed(2);
            });

            // Calculate "According to VAT Report (Excl)" = Inclusive - Output
            // For INCOME: Inclusive Income (115%) - Output (15%)
            document.querySelectorAll('.vat-report-income').forEach(span => {
                const periodKey = span.getAttribute('data-period');
                const row = document.querySelector(`tr[data-period="${periodKey}"]`);
                if (!row) return;

                // Get all inputs in the row
                const inputs = row.querySelectorAll('input.vat-input');
                // Column 1: Inclusive Income (115%)
                // Column 2: Output (15%)
                const inclusiveIncome = parseFloat(inputs[0]?.value) || 0;
                const output15 = parseFloat(inputs[1]?.value) || 0;
                
                const vatReportExcl = inclusiveIncome - output15;
                span.textContent = vatReportExcl.toFixed(2);
            });

            // For EXPENSE: Inclusive Expenses - Input VAT
            document.querySelectorAll('.vat-report-expense').forEach(span => {
                const periodKey = span.getAttribute('data-period');
                const row = document.querySelector(`tr[data-period="${periodKey}"]`);
                if (!row) return;

                // Get all inputs in the row
                const inputs = row.querySelectorAll('input.vat-input');
                // Column 6: Inclusive Expenses (115%)
                // Column 7: Input (15%)
                const inclusiveExpense = parseFloat(inputs[5]?.value) || 0;
                const input15 = parseFloat(inputs[6]?.value) || 0;
                
                const vatReportExcl = inclusiveExpense - input15;
                span.textContent = vatReportExcl.toFixed(2);
            });

            // Calculate differences: According to TB - According to VAT Report
            document.querySelectorAll('.income-diff').forEach(span => {
                const periodKey = span.getAttribute('data-period');
                const tbSpan = document.querySelector(`.tb-income-ref[data-period="${periodKey}"]`);
                const vatReportSpan = document.querySelector(`.vat-report-income[data-period="${periodKey}"]`);
                
                if (!tbSpan || !vatReportSpan) return;
                
                const tb = parseFloat(tbSpan.textContent) || 0;
                const vatReport = parseFloat(vatReportSpan.textContent) || 0;
                const diff = tb - vatReport;
                
                span.textContent = diff.toFixed(2);
            });

            document.querySelectorAll('.expense-diff').forEach(span => {
                const periodKey = span.getAttribute('data-period');
                const tbSpan = document.querySelector(`.tb-expense-ref[data-period="${periodKey}"]`);
                const vatReportSpan = document.querySelector(`.vat-report-expense[data-period="${periodKey}"]`);
                
                if (!tbSpan || !vatReportSpan) return;
                
                const tb = parseFloat(tbSpan.textContent) || 0;
                const vatReport = parseFloat(vatReportSpan.textContent) || 0;
                const diff = tb - vatReport;
                
                span.textContent = diff.toFixed(2);
            });

            // Calculate percentages: (Difference / According to TB) * 100
            document.querySelectorAll('.income-pct').forEach(span => {
                const periodKey = span.getAttribute('data-period');
                const diffSpan = document.querySelector(`.income-diff[data-period="${periodKey}"]`);
                const tbSpan = document.querySelector(`.tb-income-ref[data-period="${periodKey}"]`);
                
                if (!diffSpan || !tbSpan) return;
                
                const diff = parseFloat(diffSpan.textContent) || 0;
                const tb = parseFloat(tbSpan.textContent) || 0;
                
                if (tb === 0) {
                    span.textContent = '-';
                } else {
                    const pct = (diff / tb) * 100;
                    span.textContent = pct.toFixed(2) + '%';
                }
            });

            document.querySelectorAll('.expense-pct').forEach(span => {
                const periodKey = span.getAttribute('data-period');
                const diffSpan = document.querySelector(`.expense-diff[data-period="${periodKey}"]`);
                const tbSpan = document.querySelector(`.tb-expense-ref[data-period="${periodKey}"]`);
                
                if (!diffSpan || !tbSpan) return;
                
                const diff = parseFloat(diffSpan.textContent) || 0;
                const tb = parseFloat(tbSpan.textContent) || 0;
                
                if (tb === 0) {
                    span.textContent = '-';
                } else {
                    const pct = (diff / tb) * 100;
                    span.textContent = pct.toFixed(2) + '%';
                }
            });
        }

        // ===================================
        // LEDGER INTEGRATION
        // ===================================

        function formatCurrency(amount) {
            return 'R ' + Math.abs(amount).toLocaleString('en-ZA', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function loadVatFromLedger() {
            if (typeof LedgerSystem === 'undefined') return;

            // Get VAT report from ledger
            const vatReport = LedgerSystem.getVatReport();

            // Check if there's any VAT data
            if (vatReport.outputVat === 0 && vatReport.inputVat === 0) {
                console.log('No VAT data in ledger, keeping demo values');
                return;
            }

            // Update the summary cards
            const outputVatEl = document.getElementById('outputVatValue');
            const inputVatEl = document.getElementById('inputVatValue');
            const vatPayableEl = document.getElementById('vatPayableValue');

            if (outputVatEl) outputVatEl.textContent = formatCurrency(vatReport.outputVat);
            if (inputVatEl) inputVatEl.textContent = formatCurrency(vatReport.inputVat);
            if (vatPayableEl) {
                vatPayableEl.textContent = formatCurrency(Math.abs(vatReport.netVat));
                // Change label if refundable
                if (vatReport.refundable) {
                    const parentCard = vatPayableEl.closest('.stat-card');
                    if (parentCard) {
                        const h3 = parentCard.querySelector('h3');
                        if (h3) h3.textContent = 'VAT Refundable from SARS';
                    }
                }
            }

            console.log('VAT data loaded from ledger:', vatReport);
        }

        // Load VAT data on page load
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof LedgerSystem !== 'undefined') {
                const journals = LedgerSystem.getJournals();
                if (journals.length > 0) {
                    loadVatFromLedger();
                }
            }
        });
    </script>
</body>
</html>
